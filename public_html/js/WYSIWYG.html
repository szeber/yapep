<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title>YAPEP - Rich Text Editor</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
body {
    margin:0px; padding:0px; width:100%; height:100%;    
}
form {
    margin:0px; padding:0px;
}
BODY
{
	font-size:11px;
	font-family:Trebuchet MS, Georgia, Times;
	font-weight:normal;
	color:#404040;
}
.defaultSkin span.mce_imageNext {background-position:-860px 0}
</style>
<script type="text/javascript" src="/js/tiny_mce/tiny_mce.js"></script>
<script type="text/javascript" src="swfobject.js"></script>
<script type="text/javascript">
window.onresize = ResizeMe;
var LostHeight = 10;
var RichTextName = null;

function GetHeight()
{
	if (self.innerHeight) 
		return self.innerHeight;
	else if (document.documentElement && document.documentElement.clientWidth)
		return document.documentElement.clientHeight;
	else if (document.body)
		return document.body.clientHeight;
}	

function ResizeMe()
{
	//SetStyle("idArea"+IDoEdit1.oName, 'height', (CalculateEditorHeight())+'px');
	//SetStyle("idArea"+IDoEdit1.oName, 'width', '100%');
}

function CalculateEditorHeight()
{
	return GetHeight()-LostHeight;
}

function SetProp(objname, propname, propvalue)
{
	var o = document.getElementById(objname);
	if (o) expr = ("o."+propname+"='"+propvalue+"'");
	//alert(expr);
	eval(expr);
}

function SetStyle(objname, stylename, stylevalue)
{
	SetProp(objname, "style."+stylename, stylevalue);
}

function imageselector() {

	var o = document.getElementById('FlexDiv');
	if (o.style.display == 'none') {
		LostHeight = 240;
		o.style.display = 'block';
	} else {
		o.style.display = 'none';
		LostHeight = 0;		
	}
	document.getElementById('txtContent_ifr').style.height = (CalculateEditorHeight()-100)+'px';
	document.getElementById('txtContent_tbl').style.height = (CalculateEditorHeight())+'px';	
	
}

</script>
</head>
<body >	
<div style="height:240px;display:none;z-index: 399999;" id="FlexDiv">
	...
</div>
<form id="TheForm" name="TheForm" method="post" >
	<textarea id="txtContent" name="txtContent" style="width:100%;height:200px;"></textarea>
</form>

<script type="text/javascript">

if (window.opener && window.opener.RichTextString != null)
{
	RichTextName = window.opener.RichTextName;
	document.TheForm.txtContent.value = window.opener.RichTextString;
}

tinyMCE.init({
	theme : "advanced",
	mode : "textareas",
	save_enablewhendirty : true,
	save_callback : "Save",
			
	plugins : "save,table,contextmenu, paste, searchreplace, inlinepopups, imageNext, media,video, table",//, flash
	theme_advanced_toolbar_align : "left",
	theme_advanced_statusbar_location : 'bottom',
	theme_advanced_toolbar_location : 'top',
	
	theme_advanced_buttons1 : "save,undo,redo,|,bold,italic,underline,sub,sup,strikethrough,fontsizeselect,formatselect,charmap,forecolor,backcolor",//pastetext,pasteword,separator,search,replace,separator
	theme_advanced_buttons2 : ",justifyleft,justifycenter,justifyright,justifyfull,|,outdent,indent,|,bullist,numlist,|,hr,removeformat,separator,cut,copy,paste,pastetext,pasteword,search,replace",//flash

	theme_advanced_buttons3 : "link,unlink,anchor,image,imageNext,cleanup,help,code",
	theme_advanced_buttons3_add : "tablecontrols",

	content_css : "/css/style.css",
	body_id : "content",

	entity_encoding : "raw",


	//file_browser_callback : "imageselector",
	inline : "yes",
	relative_urls : false,
	convert_urls : false,
	remove_script_host : true,
	cleanup : true,
	verify_html : false,
	remove_linebreaks : false,
	width : '100%',
	height : CalculateEditorHeight()

		
});
	var so = new SWFObject("/swf/YapepAssets.swf", "adminswfassets", "100%", "100%", "9.0.28");
	so.addParam("flashvars", "mainUrl=&debugMode=1");
	so.addParam("wMode", "transparent");
	//so.addParam("flashvars", "");
	so.write("FlexDiv");

function Save(element_id, html, body)
{
	var str = html;
	if (window.opener && window.opener.RichTextString != null)
	{
		window.opener.SaveWYSIWYG(str, RichTextName);
	}
	window.close();	
}

function RegTest()
{
	str = oEdit1.getXHTMLBody();
	str2 = str.replace(/\n/g, "").replace(/<br[^>]*>/g, "\n").replace(/<[^>]*>/g, "");
	alert(str+"|||"+str2);
}
function doInsertFile(url, description, width, height, withBox)
{  
	tinyMCE.execCommand('mceInsertContent',false,'<a href="'+url+'">'+description+'</a>');	
}
function doInsertVideo (url, description)
{
	
}
function doInsertImage(url, description, width, height, withBox)
    {  
	    if (withBox) {
	    	var sHTML = '<div class="cikk_img" style="width:'+width+'px; border: border:1px solid #CCCCCC;color:#FF6600;float:left;font-weight:bold;margin:10px 18px 10px 0px;padding:4px;text-align:center;"><img src="'+url+'" alt="'+description+'" />'+
			description+
			'</div>';
	    	tinyMCE.execCommand('mceInsertContent',false, sHTML);		
	    } else {
	    	tinyMCE.execCommand('mceInsertContent',false,'<img src="'+url+'" alt="'+description+'" />');
	    }       
	    tinyMCE.execCommand('mceRepaint');	    
    }

</script>
</body>
</html>